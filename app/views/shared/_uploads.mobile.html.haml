.container
  .container#content_uploads
    %span{style: 'float: left;'}
      %button{id: 'media_input_init'}
        #{t('uploads.take_photo')}
    %span.btn{id: 'switch_camera'}
      %img{src: '/assets/switch-camera.png', style: 'margin: 12px 0px 0px 20px;'}
    #upload_form_ui{style: 'float:left;'}
      #media_input_container{style: 'display: none;'}
        %video{id: 'media_input_capture', style: 'width: 307px; height: 250px;', autoplay: true}
        %img{id: 'media_input_current', src: '', style: 'width: 307px; height: 250px;'}
        %canvas{id: 'media_input_display', style: 'display: none;'}
        %br
        .ui-button.ui-widget.ui-state-default.ui-corner-all.ui-button-text-only{id: 'media_input_capture_btn'}
          .ui-button-text
            #{t('uploads.take_shot').html_safe}
        .ui-button.ui-widget.ui-state-default.ui-corner-all.ui-button-text-only{id: 'media_input_stop_btn'}
          .ui-button-text
            Stop
        .ui-button.ui-widget.ui-state-default.ui-corner-all.ui-button-text-only{id: 'media_input_upload_btn'}
          .ui-button-text
            #{t('uploads.upload_photo').html_safe}
    .container
      = form_for resource, remote: true, method: :put, :html => { class: nil, :multipart => true, :id => "upload_form", target: "upload_target" } do |f|
        %span{style: 'float: left;'}
          = f.file_field 'file', id: 'fileupload'
        .field
          %span{style: 'float: left;'}
            Add a Comment on Upload
          = text_area_tag 'upload_comment[text]', '', id: 'upload_comment'
        = hidden_field_tag 'location[latitude]'
        = hidden_field_tag 'location[longitude]'
        = hidden_field_tag 'user[id]'
        %button.show-page-loading-msg{id: "upload_button", data: {type: 'json', theme: 'a', textonly: 'false', textvisible: 'true', msgtext: 'Loading'}}
          Upload
    .container
      #upload_error
      #upload_message
      #upload_progress
-# 
  .container
    %span#current_address
    - max_height = 100.0
    %h2{style: 'float:left;'}
      &lt;
    .swiper-container{style: 'float:left;'}
      .swiper-wrapper#upload_preview
        - scroll_width = 0
        - max_width = 0
        - Upload.all.order('location_id, id desc').each do |upload|
          - geometry = Paperclip::Geometry.from_file(upload.file)
          - scale = max_height.to_f / geometry.height
          - width = (geometry.width * scale + 0.49).round
          - max_width = width if width > max_width
          - height = (geometry.height* scale + 0.49).round
          - scroll_width += width
          /%span.swiper-slide{onclick: "panPosition(#{upload.location.latitude},#{upload.location.longitude},'#{escape_javascript(upload.location.address)}')"}
          %span.swiper-slide{onclick: "panUpload(#{upload.id})"}
            = image_tag upload.file.url, style: "width:#{width}px;height:#{max_height.to_i}px;"
        /- if is_mobile
        /  - max_width = '"+$(window).width()+"'
        /- else
        /  - max_width = '"+($(window).width() - 13)+"'
        - swiper_style = "width: #{max_width}px; height: #{max_height.to_i}px;"
        %script
          $("head").append("<style type='text/css'>.swiper-container, .swiper-slide { #{swiper_style} }</style>");
    %h2
      &gt;

#upload_comment_conrols{data: {role: 'popup', 'overlay-theme' => 'a', theme: 'a'}}
  %div{data: {role: 'header'}}
    %h4.ui-title #{t('uploads.add_comment')}
  %div{role: 'main'}
    = text_area_tag 'upload_comment[text]', '', id: 'add_upload_comment_text'
    = hidden_field_tag 'upload[id]', '', id: 'add_upload_comment_upload_id'
    .ui-button.ui-widget.ui-state-default.ui-corner-all.ui-button-text-only{id: 'add_upload_comment_btn'}
      .ui-button-text
        #{t('uploads.add_comment_submit')}
    %a{ id: 'upload_comment_cancel', :href => "#", :class => "btn btn-sm", data: { role: 'button', rel: 'back' } } #{t('cancel')}
      
%iframe{id: "upload_target", name: "upload_target", style: "display:none;"}


