- if is_mobile
  #content_home{role: 'main'}
    = render partial: '/sandbox/home.mobile'
- else
  #content_home
    = render partial: '/users/settings'
    = render partial: '/shared/uploads', locals: {resource: Upload.new, resource_name: :upload}
  
= render partial: '/shared/help'

= render partial: '/users/follow_templates'

= javascript_tag do
  var chatViewHeight = Math.round(($(window).height() - $(".navbar-header").height()) * 0.#{is_mobile ? 7 : 8}) - 10;
  var chatInputHeight = $(window).height() - $(".navbar-header").height() - chatViewHeight;
  $("head").append("<style type='text/css'>.chat_view {width:100%;height:"+chatViewHeight+"px !important;}</style>");
  $("head").append("<style type='text/css'>.chat_input, .chat_input_text {width:100%;height:"+chatInputHeight+"px !important;}</style>");

#content_chat
  .chat_view
  .chat_input
    = form_tag '#', method: :post, remote: true
    = text_area_tag :message, '', class: :chat_input

#content_map
  %canvas{id: 'tile_canvas', style: 'display: none; width: 256px; height: 256px;'}
  %canvas{id: 'attachment_canvas', style: 'display: none;'}
  #map
  = javascript_tag do
    var view = new VoyageX.View();
    var offlineZooms = [4,8,12,16];
    var zooms = [#{(1..16).collect{|n|",#{n}"}.join.sub(/^,/,'')}];
    var mapOptions = { center: new L.LatLng(#{@lat||Location.default.latitude}, #{@lng||Location.default.longitude}),
    zooms: zooms,
    zoom: 16,
    subdomains: ['a'],
    access_token: 'pk.eyJ1Ijoic3RlcGhhbmtvZWxsZXIiLCJhIjoiZEFHdnhwayJ9.AdtZiG5HGi5JAb64G1K-jA',
    max_zoom: 30 }
    new VoyageX.Main(view, mapOptions, offlineZooms, true) 

#tmpl_bc_chat_msg{style: 'display: none;'}
  %div{class: 'chat_message chat_message_{meOrOther} triangle-border {toggle}'}
    %img{tmpl: {src: '{foto_url}'}, style: 'float: left; max-width: 35px !important;'}
    {message}

= render partial: 'tmpl_peer_popup'

#tmpl_marker_controls{style: 'display: none;'}
  %div{tmpl: {id: 'marker_controls'}}
    %div{style: 'float: left; margin: 0px 0px 0px 5px;'}
      = link_to image_tag('add-marker.png', style: 'height: 25px;', title: t('pois.add'), alt: t('pois.add')), '#edit_poi', onclick: "javascript:APP.poiNoteInput()"
    %div{style: 'float: left; margin: 0px 0px 0px 5px; padding: 0px;'}
      = link_to image_tag('add-bookmark.png', style: 'height: 25px;', title: t('pois.bookmark'), alt: t('pois.bookmark')), '#', onclick: "javascript:APP.bookmarkLocation()"
    %div{style: 'float: left; margin: 0px 0px 0px 5px; padding: 0px;'}
      = link_to image_tag('set-home.png', style: 'height: 23px;', title: t('admin.add_homebase'), alt: t('admin.add_homebase')), '#', onclick: "javascript:APP.setHomeBase()"
    %div{style: 'float: left; margin: 0px 0px 0px 5px; padding: 0px;'}
      = link_to image_tag('home.png', style: 'height: 23px;', title: t('admin.show_homebase'), alt: t('admin.show_homebase')), '#', onclick: "javascript:APP.loadLocation({id: currentUser.homebaseLocationId})"
    %div{style: 'float: left; margin: 0px 5px 0px 5px; padding: 0px;'}
      = link_to image_tag('radar.png', style: 'height: 23px;', title: 'radar-settings', alt: 'radar-settings'), '#', onclick: "javascript:APP.radarSettings()"
    -# trace moved to radareditor
      %div{style: 'float: left; margin: 0px 5px 0px 5px; padding: 0px;'}
        %span{id: 'trace-ctrl-start-{user_id}'}
          = link_to image_tag('start_trace.png', style: 'height: 23px;', title: 'start-trace-me', alt: 'start-trace-me'), '#', onclick: "javascript:APP.toggleTrace(currentUser, {path_key})"
        %span{id: 'trace-ctrl-stop-{user_id}', style: 'display: none;'}
          = link_to image_tag('stop_trace.png', style: 'height: 23px;', title: 'stop-trace-me', alt: 'stop-trace-me'), '#', onclick: "javascript:APP.toggleTrace(currentUser, {path_key})"
    -#
      %div{style: 'margin: 0px 0px 0px 5px; padding: 0px;'}
        = link_to image_tag('arrow-up-right_off.png', style: 'height: 23px;', title: 'navigator', alt: 'navigator', class: 'photo_nav_open_icon'), '#', onclick: "javascript:APP.photoNav()"

#tmpl_note_editor{style: 'display: none;'}
  .note_editor
    %div
      Add Note
    %div{style: 'padding: 0px 0px 5px 0px;'}
      = text_area_tag :note, '{text}', id: 'note_{type}_{id}', class: :note_editor

#tmpl_radar_editor{style: 'display: none;'}
  .radar_editor
    .search_radius{style: 'float: left; padding-left: 5px;'}
      = label_tag 'search_radius_input', t('admin.search_radius')
      -#= form_tag set_user_detail_path(detail: :radar), method: :post, remote: true do
        = text_field_tag :search_radius_meters, '{search_radius_meters}', size: 7, maxlength: 7, data: {role: 'none'}
      %span#search_radius_meters>
        {search_radius_meters} m
      %div{tmpl: {id: 'search_radius_ctrl'}}
    %fieldset{data: {role: 'controlgroup'}, tmpl: {id: 'search_radius_display_fs'}}
      -#
        %div{data: {role: 'fieldcontain'}}
          %select{data: {role: 'flipswitch'}, onchange: 'toggleSearchRadiusDisplay(this)'}
            %option{value: 'show'} show
            %option{value: 'hide'} hide
      %div
        = radio_button_tag 'search_radius_display', 'show', false, id: ':tmpl', 'tmpl-id' => 'search_radius_display_show', data: {mini: true}, onclick: 'toggleSearchRadiusDisplay(this)'
        = label_tag 'search_radius_display_show', 'show'
      %div
        = radio_button_tag 'search_radius_display', 'hide', true, id: ':tmpl', 'tmpl-id' => 'search_radius_display_hide', data: {mini: true}, onclick: 'toggleSearchRadiusDisplay(this)'
        = label_tag 'search_radius_display_hide', 'hide'
    %span{style: 'float: left;'}>
      GPS:&nbsp;
    %span{tmpl: {id: 'toggle_watch_position_off'}}
      = image_tag 'locate_off.png', onclick: "toggleWatchPosition('on')", style: 'max-width: 30px; max-height: 30px;'
    %span{tmpl: {id: 'toggle_watch_position_on', style: 'display: none;'}}
      = image_tag 'locate_on.png', onclick: "toggleWatchPosition('off')", style: 'max-width: 30px; max-height: 30px;'
    %div{style: 'float: right; margin: 0px 25px 0px 5px; padding: 0px;'}
      %span{style: 'float: left;'}>
        #{t('admin.watch_position')}:&nbsp;
      %span{id: 'trace-ctrl-start-{user_id}'}
        = link_to image_tag('start_trace.png', style: 'height: 23px;', title: 'start-trace-me', alt: 'start-trace-me'), '#', onclick: "javascript:APP.toggleTrace(currentUser, {path_key})"
      %span{id: 'trace-ctrl-stop-{user_id}', style: 'display: none;'}
        = link_to image_tag('stop_trace.png', style: 'height: 23px;', title: 'stop-trace-me', alt: 'stop-trace-me'), '#', onclick: "javascript:APP.toggleTrace(currentUser, {path_key})"

#tmpl_trace-path_editor{style: 'display: none;'}
  .trace-path_editor
    %div
      {trace-paths}

#tmpl_trace-path_entry{style: 'display: none;'}
  .trace-path_entry{tmpl: {id: 'tp_e_{path_key}'}}
    = link_to '{date}', '#', onclick: "javascript:APP.view().viewTracePath(APP.storage().getUser({user_id}), '{path_key}')"
    &nbsp;
    %div{tmpl: {id: 'hide_trace-path_{path_key}'}, style: 'display: none;'}
      [
      = link_to 'hide', '#', onclick: "javascript:APP.view().hideTracePath('{path_key}')"
      ]
      [
      = link_to image_tag('delete.png', style: 'height: 15px;', title: 'delete', alt: 'delete'), '#', onclick: "javascript:APP.deleteTracePath(APP.storage().getUser({user_id}), '{path_key}')"
      ]
